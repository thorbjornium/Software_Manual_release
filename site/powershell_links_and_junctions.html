<!DOCTYPE HTML>
<html lang="en" class="nordic sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Links and junctions</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme/tabs.css">
        <link rel="stylesheet" href="mdbook-admonish.css">
        <link rel="stylesheet" href="theme/sun.css">
        <link rel="stylesheet" href="theme/catppuccin.css">
        <link rel="stylesheet" href="theme/catppuccin-admonish.css">
        <link rel="stylesheet" href="theme/nordic.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "nordic" : "nordic";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('nordic')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="sun">Sun</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="nordic">Nordic</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="latte">Latte</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="frappe">Frapp√©</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="macchiato">Macchiato</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mocha">Mocha</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>  
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/thorbjornium/Software_Manual_release" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/thorbjornium/Software-Manual/blob/main/src/powershell_links_and_junctions.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="hard-links-soft-links-symbolic-links-and-junctions-in-powershell"><a class="header" href="#hard-links-soft-links-symbolic-links-and-junctions-in-powershell">Hard Links, Soft Links (Symbolic Links), and Junctions in PowerShell</a></h1>
<ul>
<li><a href="#understanding-the-concepts">Understanding the Concepts</a></li>
<li><a href="#hard-link">Hard Link</a></li>
<li><a href="#soft-link-symbolic-link">Soft Link (Symbolic Link)</a></li>
<li><a href="#junction">Junction</a></li>
<li><a href="#powershell-cmdlets">PowerShell Cmdlets</a></li>
<li><a href="#1-creating-hard-links">1. Creating Hard Links</a>
<ul>
<li><a href="#syntax">Syntax</a></li>
<li><a href="#example">Example</a></li>
</ul>
</li>
<li><a href="#important-considerations-for-hard-links">Important Considerations for Hard Links</a></li>
<li><a href="#2-creating-soft-links-symbolic-links">2. Creating Soft Links (Symbolic Links)</a>
<ul>
<li><a href="#syntax-1">Syntax</a></li>
<li><a href="#example-1">Example</a></li>
</ul>
</li>
<li><a href="#key-points-for-soft-links">Key Points for Soft Links:</a></li>
<li><a href="#3-creating-junctions">3. Creating Junctions</a>
<ul>
<li><a href="#syntax-2">Syntax</a></li>
<li><a href="#example-2">Example</a></li>
</ul>
</li>
<li><a href="#important-details-for-junctions">Important Details for Junctions</a></li>
<li><a href="#checking-link-type">Checking Link Type</a></li>
<li><a href="#removing-links">Removing Links</a>
<ul>
<li><a href="#use-remove-item-to-remove-any-of-these-links">Use <code>Remove-Item</code> to remove any of these links</a></li>
</ul>
</li>
<li><a href="#important-notes-on-removal">Important Notes on Removal</a></li>
<li><a href="#error-handling">Error Handling</a>
<ul>
<li><a href="#its-a-good-practice-to-include-error-handling-when-creating-links">It's a good practice to include error handling when creating links</a></li>
</ul>
</li>
</ul>
<h2 id="understanding-the-concepts"><a class="header" href="#understanding-the-concepts">Understanding the Concepts</a></h2>
<h2 id="hard-link"><a class="header" href="#hard-link">Hard Link</a></h2>
<p>A hard link is essentially another name for the same file.  Both the original file and the hard link point to the same data on the disk. If you modify one, the other reflects the changes immediately because they are the same data.  You can't create hard links across different volumes/partitions.  Deleting the original file doesn't delete the data as long as at least one hard link remains</p>
<h2 id="soft-link-symbolic-link"><a class="header" href="#soft-link-symbolic-link">Soft Link (Symbolic Link)</a></h2>
<p>A soft link is a pointer to another file or directory.  It acts as a shortcut. If you modify the original file, the changes are reflected when you access the soft link. However, if you delete the original file, the soft link becomes broken (it points to a non-existent location).  Soft links <em>can</em> cross volume boundaries</p>
<h2 id="junction"><a class="header" href="#junction">Junction</a></h2>
<p>A junction (also called a directory symbolic link) is similar to a soft link, but it works specifically for directories.  It points to another directory on the <em>same</em> volume.  Like hard links, junctions continue to work even if the original directory is moved within the same volume.  They are transparent to applications; an application accessing the junction thinks it's accessing a real directory.  Junctions cannot cross volume boundaries</p>
<h2 id="powershell-cmdlets"><a class="header" href="#powershell-cmdlets">PowerShell Cmdlets</a></h2>
<p>The primary cmdlet for creating links in PowerShell is <code>New-Item</code></p>
<h2 id="1-creating-hard-links"><a class="header" href="#1-creating-hard-links">1. Creating Hard Links</a></h2>
<h3 id="syntax"><a class="header" href="#syntax">Syntax</a></h3>
<pre><code class="language-powershell">
New-Item -ItemType HardLink -Path "&lt;link_path&gt;" -Target "&lt;target_file&gt;"

</code></pre>
<h3 id="example"><a class="header" href="#example">Example</a></h3>
<pre><code class="language-powershell"># Create a hard link named 'MyHardLink.txt' to the file 'OriginalFile.txt'

New-Item -ItemType HardLink -Path ".\MyHardLink.txt" -Target ".\OriginalFile.txt"

</code></pre>
<h2 id="important-considerations-for-hard-links"><a class="header" href="#important-considerations-for-hard-links">Important Considerations for Hard Links</a></h2>
<ul>
<li>
<p>The <code>-Path</code> specifies the name and location of the <em>new</em> hard link</p>
</li>
<li>
<p>The <code>-Target</code> specifies the path to the <em>existing</em> file you want to create a hard link to</p>
</li>
<li>
<p>Hard links can only be created to files, not directories</p>
</li>
<li>
<p>Hard links must be on the same volume</p>
</li>
</ul>
<h2 id="2-creating-soft-links-symbolic-links"><a class="header" href="#2-creating-soft-links-symbolic-links">2. Creating Soft Links (Symbolic Links)</a></h2>
<h3 id="syntax-1"><a class="header" href="#syntax-1">Syntax</a></h3>
<pre><code class="language-powershell">
New-Item -ItemType SymbolicLink -Path "&lt;link_path&gt;" -Target "&lt;target_path&gt;"

</code></pre>
<h3 id="example-1"><a class="header" href="#example-1">Example</a></h3>
<pre><code class="language-powershell"># Create a symbolic link named 'MySoftLink.txt' to the file 'OriginalFile.txt'

New-Item -ItemType SymbolicLink -Path ".\MySoftLink.txt" -Target ".\OriginalFile.txt"

# Create a symbolic link named 'MyDirectoryLink' to the directory 'OriginalDirectory'

New-Item -ItemType SymbolicLink -Path ".\MyDirectoryLink" -Target ".\OriginalDirectory"

</code></pre>
<h2 id="key-points-for-soft-links"><a class="header" href="#key-points-for-soft-links">Key Points for Soft Links:</a></h2>
<ul>
<li>
<p><code>-Path</code>:  The path and name of the symbolic link</p>
</li>
<li>
<p><code>-Target</code>: The path to the file or directory the link will point to</p>
</li>
<li>
<p>Soft links can point to files or directories</p>
</li>
<li>
<p>Soft links can cross volume boundaries</p>
</li>
</ul>
<h2 id="3-creating-junctions"><a class="header" href="#3-creating-junctions">3. Creating Junctions</a></h2>
<h3 id="syntax-2"><a class="header" href="#syntax-2">Syntax</a></h3>
<pre><code class="language-powershell">
New-Item -ItemType Junction -Path "&lt;junction_path&gt;" -Target "&lt;target_directory&gt;"

</code></pre>
<h3 id="example-2"><a class="header" href="#example-2">Example</a></h3>
<pre><code class="language-powershell"># Create a junction named 'MyJunction' that points to the directory 'OriginalDirectory'

New-Item -ItemType Junction -Path ".\MyJunction" -Target ".\OriginalDirectory"

</code></pre>
<h2 id="important-details-for-junctions"><a class="header" href="#important-details-for-junctions">Important Details for Junctions</a></h2>
<ul>
<li>
<p><code>-Path</code>: The path and name of the junction (which will be a directory)</p>
</li>
<li>
<p><code>-Target</code>: The path to the <em>existing</em> directory the junction will point to</p>
</li>
<li>
<p>Junctions can only point to directories</p>
</li>
<li>
<p>Junctions must be on the same volume</p>
</li>
</ul>
<h2 id="checking-link-type"><a class="header" href="#checking-link-type">Checking Link Type</a></h2>
<p>You can use <code>Get-Item</code> to inspect the link and determine its type</p>
<pre><code class="language-powershell">
$item = Get-Item ".\MySoftLink.txt" # Replace with your link path

$item.LinkType

</code></pre>
<p>The <code>$item.LinkType</code> property will return</p>
<ul>
<li>
<p><code>HardLink</code></p>
</li>
<li>
<p><code>SymbolicLink</code></p>
</li>
<li>
<p><code>Junction</code></p>
</li>
<li>
<p><code>NotALink</code> (if it's a regular file or directory)</p>
</li>
</ul>
<h2 id="removing-links"><a class="header" href="#removing-links">Removing Links</a></h2>
<h3 id="use-remove-item-to-remove-any-of-these-links"><a class="header" href="#use-remove-item-to-remove-any-of-these-links">Use <code>Remove-Item</code> to remove any of these links</a></h3>
<pre><code class="language-powershell">
Remove-Item ".\MyHardLink.txt"

Remove-Item ".\MySoftLink.txt"

Remove-Item ".\MyJunction"

</code></pre>
<h2 id="important-notes-on-removal"><a class="header" href="#important-notes-on-removal">Important Notes on Removal</a></h2>
<ul>
<li>
<p>Removing a hard link <em>does not</em> delete the original file's data, unless it's the last hard link to that data</p>
</li>
<li>
<p>Removing a soft link <em>does not</em> delete the original file or directory. It only removes the link itself</p>
</li>
<li>
<p>Removing a junction <em>does not</em> delete the target directory or its contents. It only removes the junction point</p>
</li>
</ul>
<h2 id="error-handling"><a class="header" href="#error-handling">Error Handling</a></h2>
<h3 id="its-a-good-practice-to-include-error-handling-when-creating-links"><a class="header" href="#its-a-good-practice-to-include-error-handling-when-creating-links">It's a good practice to include error handling when creating links</a></h3>
<pre><code class="language-powershell">
try {

New-Item -ItemType SymbolicLink -Path ".\MySoftLink.txt" -Target ".\NonExistentFile.txt" -ErrorAction Stop

Write-Host "Symbolic link created successfully."

}

catch {

Write-Host "Error creating symbolic link: $($_.Exception.Message)"

}

</code></pre>
<p>The <code>-ErrorAction Stop</code> parameter will cause the script to stop immediately if an error occurs, and the <code>catch</code> block will handle the error</p>
<style>.scroll-to-top { font-size: 2.5rem; width: 3.2rem; height: 3.2rem; display: none; align-items: center; justify-content: center; position: fixed; padding: 0.75rem; bottom: 4rem; right: calc(1.25rem + 90px + var(--page-padding)); z-index: 999; cursor: pointer; border: none; color: var(--bg); background: var(--fg); border-radius: 50%; } .scroll-to-top.hidden { display: none; } .scroll-to-top i { transform: translateY(-2px); } @media (min-width: 1080px) { .scroll-to-top { display: flex; } }</style><button type="button" aria-label="scroll-to-top" class="scroll-to-top hidden" onclick="scrollToTop()"> <i class="fa fa-angle-up"></i></button><script>const scrollToTop = () => window.scroll({ top: 0, behavior: "smooth" }); window.addEventListener("scroll", () => { const button = document.querySelector(".scroll-to-top"); button.classList.toggle("hidden", window.scrollY <200); });</script>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="glow.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="ps_readline_settings.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="glow.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="ps_readline_settings.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>

        <script src="ace.js"></script>
        <script src="editor.js"></script>
        <script src="mode-rust.js"></script>
        <script src="theme-dawn.js"></script>
        <script src="theme-tomorrow_night.js"></script>

        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="theme/tabs.js"></script>
        <script src="mermaid.min.js"></script>
        <script src="mermaid-init.js"></script>
        <script src="enlarge-window.js"></script>


    </div>
    </body>
</html>
