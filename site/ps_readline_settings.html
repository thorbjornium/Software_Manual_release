<!DOCTYPE HTML>
<html lang="en" class="nordic sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Settings</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme/tabs.css">
        <link rel="stylesheet" href="mdbook-admonish.css">
        <link rel="stylesheet" href="theme/sun.css">
        <link rel="stylesheet" href="theme/catppuccin.css">
        <link rel="stylesheet" href="theme/catppuccin-admonish.css">
        <link rel="stylesheet" href="theme/nordic.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "nordic" : "nordic";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('nordic')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="sun">Sun</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="nordic">Nordic</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="latte">Latte</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="frappe">Frapp√©</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="macchiato">Macchiato</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mocha">Mocha</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>  
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/thorbjornium/Software_Manual_release" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/thorbjornium/Software-Manual/blob/main/src/ps_readline_settings.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="settings"><a class="header" href="#settings">Settings</a></h1>
<h2 id="what-is-psreadline"><a class="header" href="#what-is-psreadline">What is PSReadLine?</a></h2>
<p><code>PSReadLine</code> is a module that replaces the default PowerShell console line editor with a more feature-rich and user-friendly one. It significantly improves the command-line experience by providing:</p>
<ul>
<li><strong>Command History:</strong> Persistent and easily accessible command history.</li>
<li><strong>Syntax Highlighting:</strong> Makes code easier to read and identify errors.</li>
<li><strong>Tab Completion:</strong> Intelligent tab completion for commands, parameters, file paths, and more.</li>
<li><strong>Vi Mode:</strong> An optional editing mode that emulates the Vi/Vim text editor.</li>
<li><strong>Emacs Mode:</strong> An optional editing mode that emulates the Emacs text editor.</li>
<li><strong>Windows Mode:</strong> The default editing mode.</li>
<li><strong>Predictive IntelliSense:</strong> Suggests commands based on your history and other factors.</li>
<li><strong>Key Bindings:</strong> Customizable key bindings for common actions.</li>
</ul>
<h2 id="psreadline"><a class="header" href="#psreadline">PSReadline</a></h2>
<p>Windows Terminal has a "mark mode" that allows you to select text using the keyboard.</p>
<p>Here's how to use it:</p>
<ol>
<li><strong>Enable Mark Mode:</strong> Press <code>Ctrl + Shift + M</code>. This puts the terminal into mark mode.</li>
<li><strong>Select Text:</strong> Use the arrow keys (with <code>Shift</code> held down) to move the cursor and select the desired text. You can also use <code>Ctrl + A</code> to select all text in the terminal buffer.</li>
<li><strong>Copy Text:</strong> Once the text is selected, press <code>Ctrl + Shift + C</code> to copy it to the clipboard.</li>
</ol>
<p>Some additional information about text selection in Windows Terminal:</p>
<ul>
<li><strong>Hyperlink Navigation:</strong> In mark mode, you can use <code>Tab</code> or <code>Shift + Tab</code> to navigate between hyperlinks in the buffer if hyperlink detection is enabled (<code>experimental.detectUrls</code>).</li>
<li><strong>Block Selection:</strong> Use the <code>toggleBlockSelection</code> action to switch to block selection mode.</li>
<li><strong>Copy on Select:</strong> You can enable the <code>copyOnSelect</code> setting so that text is automatically copied to the clipboard when you select it. If this setting is enabled, right-clicking the terminal will paste the selected text.</li>
</ul>
<h2 id="psreadline-history-features"><a class="header" href="#psreadline-history-features">PSReadLine History Features</a></h2>
<p>The history features in <code>PSReadLine</code> are a major benefit. Here's a breakdown:</p>
<ul>
<li><strong>Persistent History:</strong> <code>PSReadLine</code> saves your command history to a file (by default, <code>~\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</code>). This means your commands are remembered across PowerShell sessions. <strong>You can delete unwanted entries from this file.</strong></li>
<li><strong>History Navigation:</strong>
<ul>
<li><strong>Up/Down Arrow Keys:</strong> Navigate through your command history.</li>
<li><strong>Ctrl+R (Reverse Search):</strong> Start typing a command, and <code>PSReadLine</code> will search backward through your history for matching commands. Press <code>Ctrl+R</code> repeatedly to cycle through matches.</li>
<li><strong>Ctrl+S (Forward Search):</strong> Similar to <code>Ctrl+R</code>, but searches forward. (Less commonly used).</li>
<li><strong><code>Get-History</code> Cmdlet:</strong> Retrieves the command history from the current session. This is useful for scripting or further analysis.</li>
<li><strong><code>Invoke-History</code> Cmdlet:</strong> Executes a command from the history by its ID (as shown by <code>Get-History</code>).</li>
</ul>
</li>
<li><strong>History Duplicates:</strong> By default, <code>PSReadLine</code> prevents consecutive duplicate commands from being added to the history.</li>
<li><strong>History Size:</strong> You can control the maximum number of commands saved in the history file and the maximum number of commands stored in the current session's history.</li>
<li><strong>History Location:</strong> You can change the location of the history file.</li>
</ul>
<h2 id="key-cmdlets-for-managing-history"><a class="header" href="#key-cmdlets-for-managing-history">Key Cmdlets for Managing History</a></h2>
<ul>
<li><code>Get-History</code>: Gets the history of the current session.</li>
<li><code>Get-History -Id &lt;ID&gt;</code>: Gets a specific history entry by its ID.</li>
<li><code>Get-History -Count &lt;N&gt;</code>: Gets the last N history entries.</li>
<li><code>Invoke-History</code>: Executes a command from the history.</li>
<li><code>Invoke-History &lt;ID&gt;</code>: Executes the history entry with the specified ID. You can get the ID from <code>Get-History</code>.</li>
<li><code>Add-History</code>: Adds a command to the history. (Less commonly used directly).</li>
<li><code>Clear-History</code>: Clears the history of the current session.</li>
<li><code>Clear-History -Newest &lt;N&gt;</code>: Deletes the newest N entries.</li>
<li><code>Clear-History -Oldest &lt;N&gt;</code>: Deletes the oldest N entries.</li>
</ul>
<h2 id="configuration-and-customization"><a class="header" href="#configuration-and-customization">Configuration and Customization</a></h2>
<p>You can customize <code>PSReadLine</code>'s behavior using the <code>Set-PSReadLineOption</code> cmdlet. Here are some common settings related to history:</p>
<ul>
<li><strong><code>HistorySavePath</code>:</strong> Specifies the path to the history file.</li>
</ul>
<pre><code class="language-powershell">Set-PSReadLineOption -HistorySavePath "C:\MyPowerShellHistory.txt"
</code></pre>
<ul>
<li><strong><code>MaximumHistoryCount</code>:</strong> Specifies the maximum number of commands to store in the <em>session</em> history.</li>
</ul>
<pre><code class="language-powershell">Set-PSReadLineOption -MaximumHistoryCount 4096
</code></pre>
<ul>
<li><strong><code>MaximumKillRingCount</code>:</strong> Specifies the maximum number of commands to store in the "kill ring" (used for cutting and pasting). This is less directly related to history but can affect your command editing experience.</li>
</ul>
<pre><code class="language-powershell">Set-PSReadLineOption -MaximumKillRingCount 10
</code></pre>
<ul>
<li><strong><code>HistoryNoDuplicates</code>:</strong> Specifies whether to prevent consecutive duplicate commands from being added to the history. (Defaults to <code>$true</code>).</li>
<li><strong><code>HistorySearchCaseSensitive</code>:</strong> Specifies whether history searches (<code>Ctrl+R</code>, <code>Ctrl+S</code>) are case-sensitive. (Defaults to <code>$false</code>).</li>
<li><strong><code>HistorySaveStyle</code>:</strong> Specifies how the history is saved. The default is <code>SaveIncrementally</code>, which saves each command to the history file as it's executed.</li>
</ul>
<h2 id="example-configuring-psreadline-history"><a class="header" href="#example-configuring-psreadline-history">Example: Configuring PSReadLine History</a></h2>
<p>To configure <code>PSReadLine</code> history, you typically add the <code>Set-PSReadLineOption</code> commands to your PowerShell profile. The profile is a script that runs automatically when PowerShell starts.</p>
<p><strong>1. Find Your Profile:</strong></p>
<pre><code class="language-powershell">$PROFILE
</code></pre>
<p>This will show you the path to your current PowerShell profile. If the file doesn't exist, you can create it.</p>
<p><strong>2. Edit Your Profile:</strong><br />
Open the profile file in a text editor (like VS Code or Notepad).</p>
<p><strong>3. Add Configuration:</strong><br />
Add the <code>Set-PSReadLineOption</code> commands to the profile. For example:</p>
<pre><code class="language-powershell">Set-PSReadLineOption -HistorySavePath "$env:USERPROFILE\.powershell\MyHistory.txt"
Set-PSReadLineOption -MaximumHistoryCount 10000
Set-PSReadLineOption -HistoryNoDuplicates $true
</code></pre>
<p><strong>4. Save and Restart:</strong><br />
Save the profile file and restart PowerShell. Save the profile file and restart PowerShell.</p>
<h2 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h2>
<ul>
<li><strong>History Not Saving:</strong>
<ul>
<li>Make sure <code>PSReadLine</code> is installed (<code>Get-Module PSReadLine -ListAvailable</code>). If not, install it: <code>Install-Module PSReadLine -Force</code>.</li>
<li>Check that the <code>HistorySavePath</code> is valid and that PowerShell has permissions to write to that location.</li>
<li>Ensure that <code>HistorySaveStyle</code> is set to <code>SaveIncrementally</code> (the default) or <code>SaveAtExit</code>.</li>
</ul>
</li>
<li><strong>History Not Showing Up:</strong>
<ul>
<li>Verify that <code>MaximumHistoryCount</code> is set to a reasonable value.</li>
<li>Make sure you're using the correct key bindings for history navigation (Up/Down arrows, Ctrl+R, Ctrl+S).</li>
<li>If you've recently cleared the history, it will be empty.</li>
</ul>
</li>
</ul>
<style>.scroll-to-top { font-size: 2.5rem; width: 3.2rem; height: 3.2rem; display: none; align-items: center; justify-content: center; position: fixed; padding: 0.75rem; bottom: 4rem; right: calc(1.25rem + 90px + var(--page-padding)); z-index: 999; cursor: pointer; border: none; color: var(--bg); background: var(--fg); border-radius: 50%; } .scroll-to-top.hidden { display: none; } .scroll-to-top i { transform: translateY(-2px); } @media (min-width: 1080px) { .scroll-to-top { display: flex; } }</style><button type="button" aria-label="scroll-to-top" class="scroll-to-top hidden" onclick="scrollToTop()"> <i class="fa fa-angle-up"></i></button><script>const scrollToTop = () => window.scroll({ top: 0, behavior: "smooth" }); window.addEventListener("scroll", () => { const button = document.querySelector(".scroll-to-top"); button.classList.toggle("hidden", window.scrollY <200); });</script>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="powershell_links_and_junctions.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="ps_readline_shortcuts.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="powershell_links_and_junctions.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="ps_readline_shortcuts.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>

        <script src="ace.js"></script>
        <script src="editor.js"></script>
        <script src="mode-rust.js"></script>
        <script src="theme-dawn.js"></script>
        <script src="theme-tomorrow_night.js"></script>

        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="theme/tabs.js"></script>
        <script src="mermaid.min.js"></script>
        <script src="mermaid-init.js"></script>
        <script src="enlarge-window.js"></script>


    </div>
    </body>
</html>
